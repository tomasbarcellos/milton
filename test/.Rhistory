ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm,
label=as.character(localizacao)))+
geom_point(sizee=3)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = "dodge")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 3))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm,
label=as.character(localizacao)))+
geom_point(sizee=6)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = "dodge")+
theme(axis.text.x = element_text(angle = 90, hjust = 1,size = 6))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm,
label=as.character(localizacao)))+
geom_point(size=6)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = "dodge",size=6)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm,
label=as.character(localizacao)))+
geom_point(size=4.5,alpha=0.5)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = "dodge", size=5)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm))+
geom_point(size=4.5,alpha=0.5)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = "dodge", size=5)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm))+
geom_point(size=4.5,alpha=0.5)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = dodge, size=5)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm))+
geom_point(size=4.5,alpha=0.5)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = position_dodge, size=5)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm))+
geom_point(size=4.5,alpha=0.5)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = position_dodge(width = 2), size=5)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm))+
geom_point(size=4.5,alpha=0.3)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = position_dodge(width = 3), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm))+
geom_point(size=4.5,alpha=0.3)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = position_dodge(width = 2), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=dependecia_adm))+
geom_point(size=4.5,alpha=0.3)+
geom_text(aes(label=localizacao),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
inep2015_df %>% filter(localizacao=="Total" & X5o_ano_ling_port > 0) %>% select(uf,X5o_ano_ling_port) %>% kable()
inep2015_df %>% filter(localizacao=="Total" & X5o_ano_ling_port > 0) %>% select(uf,dependecia_adm,X5o_ano_ling_port) %>% kable()
inep2015_df %>% filter(localizacao %>% c("Rural","Urbana") & X5o_ano_ling_port > 0) %>% select(uf,dependecia_adm,X5o_ano_ling_port) %>% kable()
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_bar(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_hline(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm,color="black"),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm,color=black),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm,color="black"),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm,color="#000000"),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm),hjust=0, vjust=0,
position = position_dodge(width = 0.5), size=4,color="#000000")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=0.3)+
geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
position = position_dodge(width = 0.5),
size=4,color="#000000")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=1)+
geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
position = position_dodge(width = 0.5),
size=4,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(size=2,alpha=1)+
geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
position = position_dodge(width = 0.5),
size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(mapping=aes(shape=dependecia_adm),size=2,alpha=1)+
#geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
#          position = position_dodge(width = 0.5),
#          size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(mapping=aes(shape=dependecia_adm),size=4,alpha=0.8)+
#geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
#          position = position_dodge(width = 0.5),
#          size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(mapping=aes(shape=dependecia_adm),size=4,alpha=0.6)+
#geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
#          position = position_dodge(width = 0.5),
#          size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(mapping=aes(shape=dependecia_adm),size=6,alpha=0.6)+
#geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
#          position = position_dodge(width = 0.5),
#          size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(mapping=aes(shape=dependecia_adm),size=6,alpha=0.6)+
#geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
#          position = position_dodge(width = 0.5),
#          size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
theme_bw()
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(mapping=aes(shape=dependecia_adm),size=6,alpha=0.6)+
#geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
#          position = position_dodge(width = 0.5),
#          size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
scale_color_discrete(name="Tipo")+
ylab("Nota - INEP 2015 - Português")+
lab("Unidade Federativa")+
theme_bw()
ggplot(mono_inep_2015,
aes(x=uf,
y=as.numeric(as.character(X5o_ano_ling_port)),
color=localizacao))+
geom_point(mapping=aes(shape=dependecia_adm),size=6,alpha=0.6)+
#geom_text(aes(label=dependecia_adm),hjust=0.3, vjust=0,
#          position = position_dodge(width = 0.5),
#          size=2.5,color="#000000",alpha=0.7)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
scale_color_discrete(name="Tipo")+
ylab("Nota - INEP 2015 - Português")+
xlab("Unidade Federativa")+
theme_bw()
dir()
dir
dir()
dir()
getwd()
setwd("analise-comportamento/")
library(foreign)
internet_df <- foreign::read.dta("Dados_Internet_Macedo.dta")
internet_df <- foreign::read.dta("data sets/Dados_Internet_Macedo.dta")
anova(Idade ~ Int_TempoDia,data=internet_df)
aov(Idade ~ Int_TempoDia,data=internet_df)
colnames(internet_df)
aov(Idade_Anos ~ Int_TempoDia,data=internet_df)
aov(Idade_Ano ~ Int_TempoDia,data=internet_df)
internet_df$Idade_Anos <- internet_df$Idade_Dias/365
aov(Idade_Anos ~ Int_TempoDia,data=internet_df)
aov(Idade_Anos ~ Int_TempoDia,data=internet_df)
head(internet_df$Int_TempoDia)
aov(Idade_Anos ~ Int_TempoDia,data=internet_df)
ggplot(internet_df,aes(x=Int_TempoDia,y=Idade_Anos))+
geom_boxplot()
library(ggplot2)
ggplot(internet_df,aes(x=Int_TempoDia,y=Idade_Anos))+
geom_boxplot()
summary(aov(Idade_Anos ~ Int_TempoDia,data=internet_df))
summary(aov(Idade_Anos ~ Int_TempoDia,data=internet_df))
setwd("milton/test/")
library(haven)
library(lme4)
library(magrittr)
library(rgdal)
library(OpenStreetMap)
library(ggplot2)
source("../R/public_get_addr.R") # line 14
source("../R/public_nearplace.R")
source("../R/public_geopart.R") # line 32
source("../R/public_min_dist.R") # line 39
school_points <- rbind(
c(-46.643304,-23.598400),
c(-46.633304,-23.588400),
c(-46.243304,-23.595400),
rbind(get_addr("Avenida Paulista") %>% as.numeric)) %>%
data.frame(.,names=c("A","B","C","D"))
colnames(school_points) <- c("lon","lat","names")
# Data
inpd_df<- read.csv2("../data/data-cross-lab.csv")
addr_df <- haven::read_spss("../data/geo_HRC.sav")
renda_df <- haven::read_spss("../data/Banco Renda - Merged alternativo-w0-w1 030518.sav")
addrw0_df <- addr_df[(addr_df$redcap_event_name=="wave0_arm_1"),]
w0_compl_df <- addrw0_df[complete.cases(addrw0_df[,c("lat","lon")]),]
inpd_df <- inpd_df[,c("subjectid","JAP_EF","ZJAP_EF")]
sample_coords <- w0_compl_df[,c("lon","lat")]
setor_sens <- readOGR("../data/setor censitario", # directory name
layer="DEINFO_SETOR_CENSITARIO_2010") #.shp filename
# Testing partitioning function
part_data <- geopart(shape_file=setor_sens,
dataset=w0_compl_df[-c(1:1253),]) # SP cases
test_data <- dplyr::left_join(inpd_df,part_data,by="subjectid")
test_data <- test_data[complete.cases(test_data),]
# Testing closest distance
test_data$min_school <- min_dist(coords=test_data[,c("lon","lat")],
targets=school_points)
# Closest school group level
test_data$nearplace <- nearplace(coords=test_data[,c("lon","lat")],
targets=school_points)
#
ipvs_df <- read.csv2("../data/IPVS/BaseIPVS2010.csv")
var_names <- read.table("../data/IPVS/IPVS_Dicionario.txt",
sep = "\t", fileEncoding="UCS-2LE",
header=T)
names(ipvs_df) <- var_names$Descrição
names(ipvs_df)[9] <- "CODSETOR"
test_data$CODSETOR <- test_data$CODSETOR %>% as.character %>% as.numeric
ipvs_inpd_df <- dplyr::left_join(test_data,ipvs_df,
by="CODSETOR")
ipvs_inpd_df <- dplyr::left_join(ipvs_inpd_df,renda_df[,c("subjectid","renda_total")],
by="subjectid")
ipvs_inpd_df$renda_diff <- ipvs_inpd_df$renda_total - ipvs_inpd_df$`Rendimento médio domiciliar dos domicílios particulares permanentes`
ipvs_inpd_df$geo_exp <- log(ipvs_inpd_df$`Rendimento médio domiciliar dos domicílios particulares permanentes`)
ipvs_inpd_df$geo_inv <- 1/(ipvs_inpd_df$`Rendimento médio domiciliar dos domicílios particulares permanentes`)
mp <- openmap(upperLeft=c(-23.40047,-46.8056),
lowerRight =c(-23.78056,-46.40492),
type="osm")
ipvs_inpd_df <- cbind(ipvs_inpd_df,
projectMercator(long = ipvs_inpd_df$lon,lat=ipvs_inpd_df$lat))
names(ipvs_inpd_df)[length(ipvs_inpd_df)-1] <- "lon_mer"
names(ipvs_inpd_df)[length(ipvs_inpd_df)] <- "lat_mer"
# Untested
# Tableau
p_tab <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_tableau()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F)
# Economist
p_eco <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_economist()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F)
ggsave(p_tab, width=20, height=20, units="cm",
filename="outputs/p_tab.png",dpi = 300,
type="cairo-png")
# Untested
# Tableau
p_tab <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_tableau()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F)
# Economist
p_eco <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_economist()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F)
library(ggthemes)
#Backlog
ggsave(p_tab, width=20, height=20, units="cm",
filename="outputs/p_tab.png",dpi = 300,
type="cairo-png")
# Untested
# Tableau
p_tab <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_tableau()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F)
# Economist
p_eco <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_economist()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F)
#Backlog
ggsave(p_tab, width=20, height=20, units="cm",
filename="outputs/p_tab.png",dpi = 300,
type="cairo-png")
#Backlog
ggsave(p_eco, width=20, height=20, units="cm",
filename="outputs/p_tab.png",dpi = 300,
type="cairo-png")
#Backlog
ggsave(p_eco, width=20, height=20, units="cm",
filename="outputs/p_eco.png",dpi = 300,
type="cairo-png")
#Backlog
ggsave(p_tab, width=20, height=20, units="cm",
filename="outputs/p_tab.png",dpi = 300,
type="cairo-png")
#Backlog
ggsave(p_tab, width=20, height=15, units="cm",
filename="outputs/p_tab.png",dpi = 300,
type="cairo-png")
#Backlog
ggsave(p_eco, width=20, height=15, units="cm",
filename="outputs/p_eco.png",dpi = 300,
type="cairo-png")
p_eco
# Economist
p_eco <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_economist()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F,horizontal = T)
p_eco
# Economist
p_eco <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_economist()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_economist_white(gray_bg = F,horizontal = F)
p_eco
#Backlog
ggsave(p_eco, width=20, height=20, units="cm",
filename="outputs/p_eco.png",dpi = 300,
type="cairo-png")
#Backlog
ggsave(p_tab, width=20, height=20, units="cm",
filename="outputs/p_tab.png",dpi = 300,
type="cairo-png")
#
p_new <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_economist()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_few()
p_new
#Backlog
ggsave(p_few, width=20, height=20, units="cm",
filename="outputs/p_few.png",dpi = 300,
type="cairo-png")
#Backlog
ggsave(p_new, width=20, height=20, units="cm",
filename="outputs/p_few.png",dpi = 300,
type="cairo-png")
#
p_few <- autoplot(mp)+
geom_point(aes(y=lat_mer,
x=lon_mer,
colour=as.factor(`Grupo do IPVS`),
alpha=renda_total),
data=ipvs_inpd_df,
size=2,alpha=.5)+
scale_colour_economist()+
labs(colour=paste("Classe IPVS"))+
ylab("Longitude (º)") + xlab("Latidade (º)")+
theme_few()
